<!DOCTYPE html>


<html theme="dark" showBanner="true" hasBanner="false" > 
<link href="/fontawesome/css/fontawesome.css" rel="stylesheet">
<link href="/fontawesome/css/brands.css" rel="stylesheet">
<link href="/fontawesome/css/solid.css" rel="stylesheet">
<script src="/js/color.global.min.js" ></script>
<script src="/js/load-settings.js" ></script>
<head>
  <meta charset="utf-8">
  
  
  

  
  <title>2023WMCTF——Crypto部分题目复现 | crumbling&#39;s secret room</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" href="/css/fonts/Roboto-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/Roboto-Bold.ttf" as="font" type="font/ttf" crossorigin="anonymous">
  <link rel="preload" href="/css/fonts/MaterialSymbolsRounded.woff2" as="font" type="font/woff2" crossorigin="anonymous">

  <meta name="description" content="总感觉先贴参考有点乱，这次我把参考的博客啥的都扔最后面。 badprime涉及了一个漏洞 干脆单独拿出来了。 目录  signin  signin&lt;&#x2F;h2&gt;源码： 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606">
<meta property="og:type" content="article">
<meta property="og:title" content="2023WMCTF——Crypto部分题目复现">
<meta property="og:url" content="http://example.com/2023/09/20/2023WMCTF%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/index.html">
<meta property="og:site_name" content="crumbling&#39;s secret room">
<meta property="og:description" content="总感觉先贴参考有点乱，这次我把参考的博客啥的都扔最后面。 badprime涉及了一个漏洞 干脆单独拿出来了。 目录  signin  signin&lt;&#x2F;h2&gt;源码： 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2023/09/20/2023WMCTF%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/lattice.jpg">
<meta property="article:published_time" content="2023-09-20T03:08:20.904Z">
<meta property="article:modified_time" content="2023-11-15T01:57:19.442Z">
<meta property="article:author" content="crumbling">
<meta property="article:tag" content="Crypto">
<meta property="article:tag" content="深度搜索">
<meta property="article:tag" content="hnp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2023/09/20/2023WMCTF%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/lattice.jpg">
  
    <link rel="alternate" href="/atom.xml" title="crumbling's secret room" type="application/atom+xml">
  
  
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: light)" href="/images/favicon-light-192.png" sizes="192x192">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-32.png" sizes="32x32">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-128.png" sizes="128x128">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-180.png" sizes="180x180">
    <link rel="icon" media="(prefers-color-scheme: dark)" href="/images/favicon-dark-192.png" sizes="192x192">
  
  
<link rel="stylesheet" href="/css/style.css">

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>

<body>
  
   
  <div id="main-grid" class="shadow   ">
    <div id="nav" class=""  >
      <navbar id="navbar">
  <nav id="title-nav">
    <a href="/">
      <div id="vivia-logo">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div>crumbling's secret room </div>
    </a>
  </nav>
  <nav id="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    <a id="theme-btn" class="nav-icon">
      <span class="material-symbols-rounded light-mode-icon">wb_sunny</span>
      <span class="material-symbols-rounded dark-mode-icon">dark_mode</span>
    </a>
    
      <a id="nav-rss-link" class="nav-icon mobile-hide" href="/atom.xml" title="RSS 订阅">
        <span class="material-symbols-rounded rss">rss_feed</span>
      </a>
    
    <a id="nav-search-btn" class="nav-icon" title="搜索" style="display: none;">
      <span class="material-symbols-rounded">search</span>
    </a>
    <div id="nav-menu-btn" class="nav-icon">
      <span class="material-symbols-rounded">menu</span>
    </div>
  </nav>
</navbar>
<div id="nav-dropdown" class="hidden">
  <div id="dropdown-link-list">
    
      <a class="nav-dropdown-link" href="/">Home</a>
    
      <a class="nav-dropdown-link" href="/archives">Archives</a>
    
      <a class="nav-dropdown-link" href="/about">About</a>
    
    
      <a class="nav-dropdown-link" href="/atom.xml" title="RSS 订阅">RSS</a>
     
    </div>
</div>
<script>
  let dropdownBtn = document.getElementById("nav-menu-btn");
  let dropdownEle = document.getElementById("nav-dropdown");
  dropdownBtn.onclick = function() {
    dropdownEle.classList.toggle("hidden");
  }
</script>
    </div>
    <div id="sidebar-wrapper">
      <sidebar id="sidebar">
  
    <div class="widget-wrap">
  <div class="info-card">
    <div class="avatar">
      
      <div class="img-dim"></div>
    </div>
    <div class="info">
      <div class="username">crumbling </div>
      <div class="dot"></div>
      <div class="subtitle">This is the subtitle </div>
      <div class="link-list">
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://twitter.com" title="Twitter"><i class="fa-brands fa-twitter"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://steamcommunity.com/profiles/76561199334949091/" title="Steam"><i class="fa-brands fa-steam"></i></a>
        
          <a class="link-btn" target="_blank" rel="noopener" href="https://github.com/fcrumbling" title="GitHub"><i class="fa-brands fa-github"></i></a>
         
      </div>  
    </div>
  </div>
</div>

  
  <div class="sticky">
    
      



    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">标签</h3>
      <ul class="widget-tag-list" itemprop="keywords"><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/Crypto/" rel="tag">Crypto</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/gb%E5%9F%BA/" rel="tag">gb基</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/hnp/" rel="tag">hnp</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E5%BC%80%E5%8F%91/" rel="tag">开发</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E6%A0%BC%E5%AF%86%E7%A0%81/" rel="tag">格密码</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E6%B7%B1%E5%BA%A6%E6%90%9C%E7%B4%A2/" rel="tag">深度搜索</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E7%9B%B8%E5%85%B3%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB/" rel="tag">相关明文攻击</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/" rel="tag">背包问题</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E8%87%AA%E6%88%91%E4%BB%8B%E7%BB%8D/" rel="tag">自我介绍</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E9%9B%85%E5%85%8B%E6%AF%94%E7%AC%A6%E5%8F%B7/" rel="tag">雅克比符号</a></li><li class="widget-tag-list-item"><a class="widget-tag-list-link" href="/tags/%E9%AB%98%E6%96%AF%E5%90%AF%E5%8F%91%E5%BC%8F/" rel="tag">高斯启发式</a></li></ul>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">归档</h3>
      
      
        <a class="archive-link" href="/archives/2023/12 ">
          十二月 2023 
          <div class="archive-count">1 </div>
        </a>
      
        <a class="archive-link" href="/archives/2023/11 ">
          十一月 2023 
          <div class="archive-count">3 </div>
        </a>
      
        <a class="archive-link" href="/archives/2023/10 ">
          十月 2023 
          <div class="archive-count">1 </div>
        </a>
      
        <a class="archive-link" href="/archives/2023/09 ">
          九月 2023 
          <div class="archive-count">5 </div>
        </a>
      
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="widget">
      <h3 class="widget-title">最新文章</h3>
      <ul>
        
          <a class="recent-link" href="/2023/12/03/%E5%85%B3%E4%BA%8E%E5%88%9B%E6%96%B0%E5%AE%9E%E8%B7%B51%E5%81%9A%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E5%90%8E%E7%AB%AF/" title="关于创新实践的个人博客系统后端" >
            <div class="recent-link-text">
              关于创新实践的个人博客系统后端
            </div>
          </a>
        
          <a class="recent-link" href="/2023/11/17/%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0%E9%9A%8F%E6%89%8B%E8%AE%B02/" title="" >
            <div class="recent-link-text">
              (no title)
            </div>
          </a>
        
          <a class="recent-link" href="/2023/11/12/%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0%E9%9A%8F%E6%89%8B%E8%AE%B01/" title="开发学习随手记（一）" >
            <div class="recent-link-text">
              开发学习随手记（一）
            </div>
          </a>
        
          <a class="recent-link" href="/2023/11/02/2023ACTF-crypto%E9%83%A8%E5%88%86%E5%A4%8D%E7%8E%B0/" title="2023ACTF——Crypto题目复现" >
            <div class="recent-link-text">
              2023ACTF——Crypto题目复现
            </div>
          </a>
        
          <a class="recent-link" href="/2023/10/29/DASCTF-CBCTF-crypto%E9%83%A8%E5%88%86%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/" title="DASCTF-CBCTF-crypto部分赛题复现" >
            <div class="recent-link-text">
              DASCTF-CBCTF-crypto部分赛题复现
            </div>
          </a>
        
      </ul>
    </div>
  </div>

    
  </div>
</sidebar>
    </div>
    <div id="content-body">
       

<article id="post-2023WMCTF部分题目复现" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
    
   
  <div class="article-inner">
    <div class="article-main">
      <header class="article-header">
        
<div class="main-title-bar">
  <div class="main-title-dot"></div>
  
    
      <h1 class="p-name article-title" itemprop="headline name">
        2023WMCTF——Crypto部分题目复现
      </h1>
    
  
</div>

        <div class='meta-info-bar'>
          <div class="meta-info">
  <time class="dt-published" datetime="2023-09-20T03:08:20.904Z" itemprop="datePublished">2023-09-20</time>
</div>
          <div class="need-seperator meta-info">
            <div class="meta-cate-flex">
  
    未分类 
   
</div>
  
          </div>
          <div class="wordcount need-seperator meta-info">
            1.3k 词 
          </div>
        </div>
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Crypto/" rel="tag">Crypto</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hnp/" rel="tag">hnp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B7%B1%E5%BA%A6%E6%90%9C%E7%B4%A2/" rel="tag">深度搜索</a></li></ul>

      </header>
      <div class="e-content article-entry" itemprop="articleBody">
        
          <p>总感觉先贴参考有点乱，这次我把参考的博客啥的都扔最后面。</p>
<p>badprime涉及了一个漏洞 干脆单独拿出来了。</p>
<p><strong>目录</strong></p>
<ul>
<li><a href="#1">signin</a></li>
</ul>
<h2 id="signin-lt-h2-gt"><a href="#signin-lt-h2-gt" class="headerlink" title="signin</h2>"></a><h3 id="1">signin&lt;/h2&gt;</h3></h2><p>源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="built_in">print</span>(msg)</span><br><span class="line"> </span><br><span class="line">pr(<span class="string">br"""</span></span><br><span class="line"><span class="string">                        ....''''''....                        </span></span><br><span class="line"><span class="string">                     .`",:;;II;II;;;;:,"^'.                    </span></span><br><span class="line"><span class="string">                  '"IlllI;;;;;;;;;;;;;Il!!l;^.                 </span></span><br><span class="line"><span class="string">                `l&gt;&lt;&gt;!!!!!!!!iiiii!!!!!!!!i&gt;&lt;!".               </span></span><br><span class="line"><span class="string">             ':&gt;?]__++~~~~~&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;~~+__i".            </span></span><br><span class="line"><span class="string">           .:i+}{]?-__+++~~~~~~&lt;&lt;&lt;&lt;&lt;~~~~~~+_-?[\1_!^           </span></span><br><span class="line"><span class="string">          .;&lt;_}\{]-_++~&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;~+-?]\|]+&lt;^          </span></span><br><span class="line"><span class="string">          .!-{t|[?-}(|((){_&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;_}1)))1}??]{t|]_"          </span></span><br><span class="line"><span class="string">           !)nf}]-?/\){]]]_&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;_]]}}{\/?-][)vf?`          </span></span><br><span class="line"><span class="string">          '!tX/}]--&lt;]{\Un[~~&lt;&lt;&lt;&lt;&lt;~~&lt;~-11Yz)&lt;--?[{vv[".         </span></span><br><span class="line"><span class="string">         .&lt;{xJt}]?!ibm0%&amp;Ci&gt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;!0kJW%w+:-?[{uu)},         </span></span><br><span class="line"><span class="string">          !1fLf}]_::xmqQj["I~&lt;&lt;&lt;&lt;&lt;&lt;&gt;"(ZqOu{I^&lt;?[{cc)[`         </span></span><br><span class="line"><span class="string">          `}|x\}]_+&lt;!&lt;+~&lt;&lt;__~&lt;&lt;&lt;&lt;&lt;&lt;+_&lt;&lt;_+&lt;&gt;&lt;++-[1j/(&gt;          </span></span><br><span class="line"><span class="string">           !\j/{]-++___--_+~~&lt;i;I&gt;~~~__-______?}(jf}`          </span></span><br><span class="line"><span class="string">            ;~(|}?_++++~~++~+]-++]?+++~~~~+++-[1/]&gt;^           </span></span><br><span class="line"><span class="string">              ;\([?__+_-?]?-_-----__-]?-_+++-]{/].             </span></span><br><span class="line"><span class="string">               l||}?__/rjffcCQQQQQLUxffjf}+-]1\?'              </span></span><br><span class="line"><span class="string">                ,[\)[?}}-__[/nzXXvj)?__]{??}((&gt;.               </span></span><br><span class="line"><span class="string">                 .I[|(1{]_+~~~&lt;~~&lt;&lt;&lt;~+_[}1(1+^                 </span></span><br><span class="line"><span class="string">                    ,~{|\)}]_++++++-?}1)1?!`                   </span></span><br><span class="line"><span class="string">                      ."!_]{11))1{}]-+i:'                      </span></span><br><span class="line"><span class="string">                          .`^","^`'.                           </span></span><br><span class="line"><span class="string">"""</span>.decode())</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_prime</span>(<span class="params">bit</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        P = getPrime(bit)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(P)) - <span class="number">2</span> == bit:</span><br><span class="line">            <span class="keyword">return</span> P</span><br><span class="line"> </span><br><span class="line">pq_bit = <span class="number">512</span></span><br><span class="line">offset = <span class="number">16</span></span><br><span class="line"> </span><br><span class="line">P,Q = [gen_prime(pq_bit) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">N = P * Q</span><br><span class="line">gift = <span class="built_in">int</span>(<span class="built_in">bin</span>(P ^ (Q &gt;&gt; offset))[<span class="number">2</span>+offset:],<span class="number">2</span>)</span><br><span class="line">pr(N)</span><br><span class="line">pr(gift)</span><br><span class="line"> </span><br><span class="line">inpP = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="keyword">if</span> inpP != P:</span><br><span class="line">    pr(<span class="string">b"you lose!"</span>)</span><br><span class="line">    exit()</span><br><span class="line"> </span><br><span class="line">secret = randrange(<span class="number">0</span>,P)</span><br><span class="line">bs = [randrange(<span class="number">0</span>,P) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>)]</span><br><span class="line"> </span><br><span class="line">results = [(bi * secret) % P <span class="keyword">for</span> bi <span class="keyword">in</span> bs]</span><br><span class="line">rs = [ri &amp; (<span class="number">2</span> ** offset - <span class="number">1</span>)  <span class="keyword">for</span> ri <span class="keyword">in</span> results]</span><br><span class="line"> </span><br><span class="line">pr(bs)</span><br><span class="line">pr(rs)</span><br><span class="line">inpsecret = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="keyword">if</span> inpsecret == secret:</span><br><span class="line">    pr(flag)</span><br></pre></td></tr></table></figure>
<h3 id="第一部分"><a href="#第一部分" class="headerlink" title="第一部分"></a>第一部分</h3><p>和前两天七月赛类似的问题，比赛的时候改了深搜的写法但是没有出来结果（深搜部分+cooper；深搜+爆破gift高位，前一个2小时没出东西，后一个代码没跑完）。</p>
<p><strong>解法一</strong>：来自学长tr0uble。在确定p的高位后通过N//p求出p的高x位，然后再利用gift异或求p接下来的x位，不停重复（考虑进位x选择一个小于16的数）。不过因为这次无法直接从gift获得p的高16位，所以爆破p的高16位。这种解法显然效率比深搜高。<del>七月赛那题只复现了深搜简直是大伏笔啊啊啊啊啊啊</del></p>
<p>以下是核心部分：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">xbits=<span class="number">8</span></span><br><span class="line"><span class="keyword">for</span> p_high <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">    p_highbit=<span class="built_in">bin</span>(p_high)[<span class="number">2</span>:].zfill(<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>((<span class="number">512</span>-<span class="number">16</span>)//xbits):</span><br><span class="line">        p0=<span class="built_in">int</span>(p_highbit.ljust(<span class="number">512</span>,<span class="string">'0'</span>),<span class="number">2</span>)</span><br><span class="line">        qbar=N//p0</span><br><span class="line">        q_highbit=<span class="built_in">bin</span>(qbar)[<span class="number">2</span>:]</span><br><span class="line">        left=i*xbits</span><br><span class="line">        right=left+xbits</span><br><span class="line">        p_xbits=<span class="built_in">bin</span>(<span class="built_in">int</span>(q_highbit[left:right],<span class="number">2</span>)^<span class="built_in">int</span>(gift[left:right], <span class="number">2</span>))[<span class="number">2</span>:].zfill(xbits)</span><br><span class="line">        p_highbit+=p_xbits</span><br><span class="line">    p=<span class="built_in">int</span>(p_highbit,<span class="number">2</span>)</span><br><span class="line">    q=N//p</span><br><span class="line">    <span class="keyword">if</span> p*q==N:</span><br><span class="line">        <span class="built_in">print</span>(p)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<p>x选择8还挺巧妙的，七月赛wp中有见过选择10还是5的，会导致留下几位需要爆破，8是刚刚好求出p，同理x=4也一样.</p>
<p><em>ljust函数用于右填充0直到512位，并且左对齐，和zfill刚好相反</em></p>
<p><strong>解法二</strong>：来自<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_52640415">石氏是时试</a>。思路是深搜，但搜法是爆破phigh然后从高位进行深搜。</p>
<p>gift的条件用在了 <code>if v=='0'</code>,一次淘汰一半；</p>
<p>N的条件用在了<code>if tp*tq&gt;N</code> <code>if (tp+(1&lt;&lt;(l+1)))*(tq+(1&lt;&lt;(l+17)))&lt;N</code></p>
<p>和低位搜比可以减少一个2**15的爆破，从O(n^2)到了O（n）。所以在较短时间内出的来结果，不过代价是fac函数里面打了不少“补丁”。</p>
<p>同样重新整合了一份核心代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fac</span>(<span class="params">allgift,tp,tq</span>):</span><br><span class="line">    <span class="keyword">global</span> p </span><br><span class="line">    <span class="keyword">if</span> p != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(allgift) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">if</span> tp*tq&gt;N:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">if</span> N%(tp+<span class="number">1</span>)==<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(tp+<span class="number">1</span>)</span><br><span class="line">        p=tp+<span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    prebit = allgift[<span class="number">0</span>]</span><br><span class="line">    allgift0 = allgift[<span class="number">1</span>:]</span><br><span class="line">    l = <span class="built_in">len</span>(allgift0)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (tp+(<span class="number">1</span>&lt;&lt;(l+<span class="number">1</span>)))*(tq+(<span class="number">1</span>&lt;&lt;(l+<span class="number">17</span>)))&lt;N:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> prebit == <span class="string">'0'</span>:</span><br><span class="line">       fac(allgift0, tp, tq)</span><br><span class="line">       fac(allgift0, tp+(<span class="number">1</span>&lt;&lt;l), tq+(<span class="number">1</span>&lt;&lt;(l+<span class="number">16</span>)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">       fac(allgift0, tp+(<span class="number">1</span>&lt;&lt;l), tq)</span><br><span class="line">       fac(allgift0, tp, tq+(<span class="number">1</span>&lt;&lt;(l+<span class="number">16</span>)))</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">N = <span class="number">98979914203938129582559002435937496221944524872097792710858591458834482668375238153375967732236519828009052634712155154350690793290568934757567632244582037302853487654784427703489685593524935643730962265977918060749885961377108833870686012325836049467328687008560530162352822066119244817994253171179069223963</span></span><br><span class="line">gift = <span class="number">155694596915298991572712835680119486137562835299346062724576858196467035731310426290930425057431831070744019220387957576198359284021046204571309474734</span></span><br><span class="line">offset = <span class="number">16</span></span><br><span class="line">allgift = <span class="built_in">bin</span>(gift)[<span class="number">2</span>:].zfill(<span class="number">512</span>-offset)</span><br><span class="line">p = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> phigh <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">15</span>):</span><br><span class="line">    tp = (<span class="number">1</span>&lt;&lt;<span class="number">511</span>)+ (phigh&lt;&lt;<span class="number">512</span>-offset-<span class="number">1</span>)</span><br><span class="line">    tq = <span class="number">1</span>&lt;&lt;(<span class="number">511</span>)</span><br><span class="line">    fac(allgift,tp,tq)</span><br><span class="line">    <span class="keyword">if</span> p != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span> </span><br></pre></td></tr></table></figure>
<p>深搜还真是深奥orz</p>
<p><strong>解法三：</strong>官方wp。</p>
<h3 id="第二部分"><a href="#第二部分" class="headerlink" title="第二部分"></a><strong>第二部分</strong></h3><p>hnp，但是改过一点的hnp</p>
<p>看到了新的wp，可以复现构造的矩阵了。</p>
<p>ri=(bi<em>s)%p %2*</em>16</p>
<p>ri=bi*s+k*p+l*2**16</p>
<p>l*2<em>*16=bi\</em>s-ri (mod p)</p>
<p>inv=inverse(2**16,p)</p>
<p>l=bi*s*inv-ri*inv+k*p</p>
<p>大小:ri——16bits；bi,s,p——512bits;l——（512-16）bits</p>
<p>构造： </p>
<p>（ 公式块在网页上显示不出来矩阵，总之改成截图。）</p>
<p><img src="/2023/09/20/2023WMCTF%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/lattice.jpg" alt="lattice"></p>
<p>其中</p>
<p>n=37,K=2**496(因为l为496位，对于由512位的p决定大小的格而言较小，若K过大会导致不是最短向量)</p>
<p><code>tmpb = [int(bi * inverse_mod(2**16,p)) for bi in bs]</code></p>
<p><code>tmpc = [int(ri * inverse_mod(2**16,p))  for ri in rs]</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">9463395021022080495725625579099709864198202996192818493676075430361086175809577174253865589866353281287908307347544682931439681148579311956298173287376473</span></span><br><span class="line">b = [<span class="number">6099745272052586004179912608738971034534930536137743613897081917185107394368705591323971750395506839750452649288267772188419489756675205679949408086451232</span>, <span class="number">3951191747812729045440242820895124607189480251095163295242628450942998752364973601131023646206377502005591988554681151953526704565202075013281769088815523</span>, <span class="number">1404420597554404030107272770922253996678162333687352195618251218863999850248824692838151822875031075053556888677319712477280556217652901167451648905364386</span>, <span class="number">4488294572333656708259420377539737505003996159677656468026097114601711607985567015550450770914323371829296766770532559711193361180597308950367687185966302</span>, <span class="number">5481102322187479419436505829074865646684095327365195150222467418442873465357487402747218531517017371054667814520443813042860956594726076176855372054132653</span>, <span class="number">2713802788133698269409249999536200419140314121130473258656206052429002170951741696862581935955915442467962543363756219468741646383480138223283730677285687</span>, <span class="number">4388471418937878873760244311226931102311967761139597301227595095454037495066960891301104963760391091058605030114648033892461656189445282496553583505973028</span>, <span class="number">736776464731641575781839292404124851285324500513593675528872423711514787996001241149637426869001948983773230073266488914216375314221965655672656410584443</span>, <span class="number">8708590989237325341864969642266721092908150322862807883501307022447092127465507299112990850265948137001397701186114982614486130822490540038423320215334626</span>, <span class="number">9267802304424548397960617736597723635936811251609846290761762903654804678628923862108480264307805107896646269881938313148864202456071920121260093838052525</span>, <span class="number">3247108183860325987343060073325154780063121072412546176464075975152503493018889336496636379292425449406827070404175667145192082945885628262842725864496476</span>, <span class="number">455724435639473173230575250620919313737714978926744740871167992567140510847659696368128186714204899204016766561731806278682654146614456839201295265351084</span>, <span class="number">9020040064239438957325652010732562703496153379776291386479249377336002129977498901663356523568148111515751758815532962162768918028366620424504879498916260</span>, <span class="number">7688416580027582769915116662018701330731542853610728083638475681090388890585799679692871117954618858316092856071130163834051800086038254809868956867017534</span>, <span class="number">2914081803071475210765607707004526189627879912343305436165346830733180111712927683631299251265551199278425089831815911602268284636090898745079700939295508</span>, <span class="number">1682447624444059192944751083327557927345592086507420627567050313041103192041463642408780131750529259046595170811376763889856062916108841799386014250209204</span>, <span class="number">5341034619247476123738204666831636378756603282709541857595527812139022510035477000927339770989486054395218479620330803691178416464134942884723827374332572</span>, <span class="number">8376329702107133848458122442144946089340952412870283575988871694491609215583935392751355281411100977914041577559011007450313560473364023276862308392837927</span>, <span class="number">9416263788845104843254295633755080717027180798661946550343273052573861692993756745844265654941124801439244186152547374828735493445699134588163894749640836</span>, <span class="number">2932216738770537817881515093909708415125754815604299999068133848728425671241756819969645781862996905460305910366082553247028095515273709817106865465122590</span>, <span class="number">8097717669926537250731305609873869963442989665404721303119492230921259587448045170648745406003491170455200904721392690716080842205006420218957357208236777</span>, <span class="number">2320095372469412381123081241813969183059217183055092564165616040030126466741691823966421813308525807455783827406201671916779545841711101790509143391460558</span>, <span class="number">2333972164269303480468982231430944844261058855427800172027932923131801032739273832904738225066210544462847760672864166563796956687623202151756145595323299</span>, <span class="number">9437506711046580131962727129679057367842176159058408153672713703801123411305447877847753662475828865148714651927615052959365575959980181945973888298104933</span>, <span class="number">5802961795945602293929959252989205060907182950209184792016006564685164829079522333038011701596715377738492900250485584441351844045455427769773524087524156</span>, <span class="number">529599427933984238231472476175004896612420169200926563371105835757115041890610229232923121353193340603425988395343027602415343623433336040543795697317090</span>, <span class="number">6402196372034668863055877348065973921962422590516519136977866652600902486323081042430853494022971845631884452544526687998575817840711058028440421779395606</span>, <span class="number">1230624307875405241534590705586346034433600380745178644341864997283918237998339933919925940523713299382838409046998100995049951280382526255707022024214853</span>, <span class="number">4939399750563474831690751351208621006534538497525744056731033390661498923441407195386308647381246454241105286776645577202434999611495000302402098783151142</span>, <span class="number">3991859998040542133259043036343592584436362790235923761833962209989024458819225460294422336721726048826788046849829864060207989750046644621835589699009365</span>, <span class="number">240857736341741610087615111623321249370900668053282004036464835672779328135852021912344864307291860960709711372109427660351057177543937799209410049857688</span>, <span class="number">3616083502398202892601882038165628001289992103457989351932690769228627486934029132426774534679657144138989265564646117621513540781010324410148517674825531</span>, <span class="number">5404612891952879264496112103405811484626424108411041737043110667122266883638660766432812414542841773559389510234873119005979364687689717241678676878972572</span>, <span class="number">2034451564894992453342874697889924929640864497213866812897528594902646690104681644785346511630568960798405400466505451930160617969903308178504532997741868</span>, <span class="number">6157490304505265465913231571555412606905748047618103662427174891510009729459475829640015546085845764226272377180939793932164111694580454672032316588788226</span>, <span class="number">4975964317099024183607476155053005595563615534064262974131837949918711606891694740515965242556735284295717544308022169459365947195601426949094207557584822</span>, <span class="number">5428476883706514219777167145065847042077736528683727164449312172005302805331073867565107042753732467573625669359225318663458427411189319424302379038071051</span>, <span class="number">1671914205500553673647970410143909519671590636952787351672356207441593565754364343607635690418391473360926097632568317796984733317042685849430234554815858</span>]</span><br><span class="line">r = [<span class="number">48997</span>, <span class="number">62415</span>, <span class="number">23955</span>, <span class="number">36908</span>, <span class="number">52443</span>, <span class="number">4523</span>, <span class="number">22645</span>, <span class="number">22555</span>, <span class="number">31815</span>, <span class="number">15691</span>, <span class="number">47858</span>, <span class="number">27532</span>, <span class="number">21464</span>, <span class="number">23465</span>, <span class="number">45849</span>, <span class="number">59181</span>, <span class="number">27490</span>, <span class="number">6614</span>, <span class="number">16702</span>, <span class="number">57463</span>, <span class="number">52700</span>, <span class="number">28969</span>, <span class="number">31173</span>, <span class="number">41233</span>, <span class="number">61893</span>, <span class="number">36368</span>, <span class="number">17734</span>, <span class="number">53549</span>, <span class="number">17913</span>, <span class="number">33308</span>, <span class="number">63024</span>, <span class="number">61345</span>, <span class="number">33511</span>, <span class="number">53005</span>, <span class="number">26113</span>, <span class="number">59084</span>, <span class="number">35720</span>, <span class="number">44204</span>]</span><br><span class="line"></span><br><span class="line">M = matrix(QQ,<span class="number">40</span>,<span class="number">40</span>)</span><br><span class="line">inv = invert(<span class="number">2</span> ** <span class="number">16</span>,p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>):</span><br><span class="line">    M[i,i] = p</span><br><span class="line">    M[-<span class="number">2</span>,i] = b[i] * inv</span><br><span class="line">    M[-<span class="number">1</span>,i] = -r[i] * inv</span><br><span class="line">    </span><br><span class="line">M[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">2</span> ** <span class="number">496</span> / p</span><br><span class="line">M[-<span class="number">1</span>,-<span class="number">1</span>] = <span class="number">2</span> ** <span class="number">496</span></span><br><span class="line"></span><br><span class="line">L = M.LLL()</span><br><span class="line"></span><br><span class="line">res = L[<span class="number">1</span>][-<span class="number">2</span>].numerator() / <span class="number">2</span> ** <span class="number">496</span></span><br><span class="line"><span class="comment"># 或 res = L[1][-2] / (2 ** 496 / p) % p</span></span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># 1005444529226476196286726437221411001182466035947403146822894574200213482908472882296123424897230218596631139138335919912390102402492391521467426075919696</span></span><br><span class="line"><span class="comment"># wmctf{we1c0me_brOo0Oo!hope_y0u_h4v3_fun_iN_the_fTcmWWmcTf/}</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>和官方wp稍有不同，tmpb与tmpc没有进行左移16操作，格的右下两个数据也稍有不同，但是对于hnp的介绍以及本题推导更清晰，所以还是用了（见最后一个参考博客）</p>
<p>题外话，markdown语言在博客上显示的很难受，急需一个解决方案</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_52640415/article/details/132417185">WMCTF 2023] crypto_石氏是时试的博客-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41626232/article/details/132418990">WMCTF2023 Crypto_无趣的浅的博客-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.wm-team.cn/index.php/archives/39/">https://blog.wm-team.cn/index.php/archives/39/</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/XiongSiqi_blog/article/details/132377349">WMCTF-2023-Crypto_Emmaaaaaaaaaa的博客-CSDN博客</a></p>

        
      </div>

         
    </div>
    
     
  </div>
  
    
<nav id="article-nav">
  <a class="article-nav-btn left "
    
      href="/2023/10/29/DASCTF-CBCTF-crypto%E9%83%A8%E5%88%86%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/"
      title="DASCTF-CBCTF-crypto部分赛题复现"
     >
    <i class="fa-solid fa-angle-left"></i>
    <p class="title-text">
      
        DASCTF-CBCTF-crypto部分赛题复现
        
    </p>
  </a>
  <a class="article-nav-btn right "
    
      href="/2023/09/19/LFSR/"
      title="LFSR学习"
     >

    <p class="title-text">
      
        LFSR学习
        
    </p>
    <i class="fa-solid fa-angle-right"></i>
  </a>
</nav>


  
</article>

 
    </div>
    <div id="footer-wrapper">
      <footer id="footer">
  
  <div id="footer-info" class="inner">
    
    &copy; 2023 crumbling<br>
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & Theme <a target="_blank" rel="noopener" href="https://github.com/saicaca/hexo-theme-vivia">Vivia</a>
  </div>
</footer>

    </div>
    <div class="back-to-top-wrapper">
    <button id="back-to-top-btn" class="back-to-top-btn hide" onclick="topFunction()">
        <span class="material-symbols-rounded">keyboard_arrow_up</span>
    </button>
</div>

<script>
    function topFunction() {
        window.scroll({ top: 0, behavior: 'smooth' });
    }
    let btn = document.getElementById('back-to-top-btn');
    function scrollFunction() {
        if (document.body.scrollTop > 600 || document.documentElement.scrollTop > 600) {
            btn.classList.remove('hide')
        } else {
            btn.classList.add('hide')
        }
    }
    window.onscroll = function() {
        scrollFunction();
    }
</script>

  </div>
  <script src="/js/light-dark-switch.js"></script>
</body>
</html>
